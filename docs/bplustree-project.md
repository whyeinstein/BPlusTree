# B+Tree 任务书

## 任务目标

- 理解 B+Tree 的意义和作用。
- 掌握 B+Tree 的基本结构和操作。
- 加强 C++ 编程能力，对 OOP、模板、泛型、多线程、文件 I/O 有更深入的理解。
- 提升 C++ 项目的构建能力，熟悉库的使用、文件组织结构、构建工具、代码规范等内容。
- 提升软件工程能力，熟悉测试、文档撰写、版本控制等内容。

## 任务内容

### 功能

- **阶段一**：实现 B+Tree 的基本结构，以及插入、删除、（范围）查找几种操作。
  - 用 OOP 思想设计 B+Tree，要求内部节点和叶子节点继承自同一个基类。
  - 使用模板技术，使 B+Tree 至少支持整型、字符串两种类型的 Key。Value 只需支持 `uint64_t` 类型。
- **阶段二**：实现 B+Tree 的序列化和反序列化，使 B+Tree 可以持久化到磁盘上。
  - 序列化方式自定，文件数量不做要求。
  - 文件 I/O 的选择上考虑跨平台问题。
- **阶段三**：使用 latch crabing 并发策略实现对 B+Tree 的多线程并发访问。
  - 使用 C++ 标准的并发库。

### 测试

- **阶段一**：基本结构与操作的测试。
  - 单元测试：测试几种操作是否按照预期执行。
  - 性能测试：测试不同度数下，B+Tree 几种操作的性能。
- **阶段二**：序列化和反序列化测试。
  - 单元测试：测试序列化和反序列化是否按照预期执行。
- **阶段三**：多线程并发测试。
  - 单元测试：测试多线程并发访问 B+Tree 是否按照预期执行。
  - 性能测试：测试不同线程数下，B+Tree 几种操作的性能。

## 任务要求

- 使用 git 进行版本控制，使用 GitHub 托管代码。
- 使用 CMake 或 Makefile 构建项目。
- 项目文件组织结构清晰，使用 `include`、`src`、`test`、`doc` 等目录管理文件。
- 使用 clang-format 和 clang-tidy 规范代码。
- 使用 Google Test 编写测试代码。
- 使用 Valgrind 工具检查内存泄漏。
- 使用 gprof、perf 等工具分析程序性能。
- 使用 Draw.io、Python Matplotlib、StarUML 等工具绘制架构图、流程图、折线图、类图等。
- 输出项目文件，包括：
  - 源代码。
  - 任务报告文档。三个阶段用同一个报告，分阶段迭代更新文档。
  - 其他文件，例如 CMake 文件、构建脚本、clang-format 文件等。

## 任务报告模板

```markdown
# B+Tree 任务报告

## 1 项目背景

B+Tree 原理、意义、应用场景等。

## 2 详细设计（重要）

### 2.1 总体架构

架构图或类图。

### 2.2 关键流程

介绍插入、删除、查找、序列化、反序列化、并发控制等关键流程。
使用流程图、数据布局图等辅助说明。

## 3 代码实现

### 3.1 目录组织

介绍一下各目录的作用。

### 3.2 安装&测试

说明如何编译、安装、运行测试。

### 3.3 接口

公共接口。

### 3.4 关键代码

重要或有意思的代码片段。

### 3.5 程序分析

内存泄漏分析，gprof/perf 代码性能分析。

## 4 测试

### 4.1 单元测试
```

### 4.2 性能测试

## 5 总结

总结困难问题的解决思路，以及收获与心得体会。
